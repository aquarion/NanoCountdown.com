<html>
<head>
  <title>Nanowrimo Countup</title>  

<style type="text/css">

#surround {
  margin: 15% auto 0px auto; text-align:center; color:#000;
  font-size: 18pt;
  min-height: 400px;
}

#countdown {
  font-family: "consolas", monospace;
  font-size: 100px;
}

#footer {
  width 100%;
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  color: white;
  background: black;
  line-height: 2em;
  text-align: center;
  font-family: sans-serif;
}

#footer a {
  color: white;
}

</style>

</head>


<body> 
  <!-- Traditionally, there are jokes in the comments of these things. This time, the joke's on you -->
  <div id="surround">
    To hit the deadline, you should have written
    <h1 id="countdown"></h1>
    <p id="explain">words by now. You have <span id="remaining"></span> left</p>
  </div>
  
  <div id="footer">
    The fault of <a href="http://www.aquarionics.com">Aquarion</a>, bother me on twitter as <a href="http://www.twitter.com/aquarion">@Aquarion</a>, <br/>
    Official hashtag: "<a href="https://twitter.com/#!/search/%23BastardWidget">#BastardWidget</a>" (Thanks to <a href="http://www.twitter.com/LondonNaNo">@LondonNaNo</a>
    and <a href="http://www.twitter.com/Enzo_v2">@Enzo_v2</a>) 
  </div>
  
  
  
<script type="text/javascript">

var countdown = document.getElementById("countdown");
var remaining = document.getElementById("remaining");

now = new Date;

year = now.getYear();
  
if (year < 2000){
  year = now.getYear()+1900;
}

var deadline    = new Date(year,11,1,0,0,0);
var startdate   = new Date(year,10,1,0,0,0);

var targetWords = 50000;
var month       = deadline-startdate;
var persec      = targetWords/month;

var days        = 1000*60*60*24;
var hours       = 1000*60*60;
var minutes     = 1000*60;
var seconds     = 1000

var was_countup = false;

function formatNumber(num)
{    
    var n = num.toString();
    var nums = n.split('.');
    var newNum = "";
    if (nums.length > 1)
    {
        var dec = nums[1].substring(0,2);
        newNum = nums[0] + "," + dec;
    }
    else
    {
    newNum = num;
    }
    return num;
}

function countdown_string(remain){
    
  remain_string = "";
  result = remain/days | 0
  if (result > 4){
    word = "day";
    if (result != 1) {word += "s";}
    
    remain_string += result+" "+word+", ";
    remain = remain % days;
  }
  
  result = remain/hours | 0
  if (result > 12 || result < 200 ){
    word = "hour";
    if (result != 1) {word += "s";}
    remain_string += result+" "+word;
    remain = remain % hours;
  }
  
  result = remain/minutes | 0
  if (result){
    word = "minute";
    if (result != 1) {word += "s";}
    remain_string += ", "+result+" "+word;
    remain = remain % minutes;
  }
  
  result = remain/seconds | 0
  if (result){
    word = "second";
    if (result != 1) {word += "s";}
    remain_string += ", "+result+" "+word;
    remain = remain % seconds;
  }
  
  return remain_string
    
}

function updateCountdown(){
  now    = new Date();
  delta  = (now-startdate);
  words  = (delta*persec).toFixed(2);
  remain = (deadline-now);
  
  if (now > deadline){
    countdown.innerHTML = "50,000";
    remaining.innerHTML = "no time";
    return;
  }
  
  if (now < startdate){
    was_countup = true;
    
    countdown.innerHTML = "Nothing";
    
    untilstart = startdate-now;
    
    remain_string = countdown_string(untilstart); 
    
    explain.innerHTML = "Nanowrimo "+year+" starts in " + remain_string;
    setTimeout("updateCountdown()", 1000);
    return;
  }
  
  if (was_countup){
      location.reload(true);
  }
  
  
  setTimeout("updateCountdown()", 100);
  countdown.innerHTML = formatNumber(words);
  document.title = formatNumber(words);
  remaining.innerHTML = countdown_string(remain);
  
}

updateCountdown();

</script>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-19437942-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</body>
</html>
